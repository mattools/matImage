function tests = test_imInscribedCircle
% Test suite for the file imInscribedCircle.
%
%   Test suite for the file imInscribedCircle
%
%   Example
%   test_imInscribedCircle
%
%   See also
%     imInscribedCircle

% ------
% Author: David Legland
% e-mail: david.legland@inrae.fr
% Created: 2021-01-11,    using Matlab 9.8.0.1323502 (R2020a)
% Copyright 2021 INRAE - BIA-BIBS.

tests = functiontests(localfunctions);

function test_SimpleRect(testCase) %#ok<*DEFNU>
% Test call of function without argument.

img = zeros(100, 100, 'uint8');
img(30:60, 20:80) = 1;

circle = imInscribedCircle(img);

assertEqual(testCase, size(circle), [1 3]);
assertEqual(testCase, circle(3), 16, 'AbsTol', 0.01);


function test_MultiLabels(testCase) %#ok<*DEFNU>
% Test call of function without argument.

img = [ ...
    0 0 0 0 0 0 0 0 0 0 0; ...
    0 1 1 1 0 4 4 4 4 4 0; ...
    0 1 1 1 0 4 4 4 4 4 0; ...
    0 1 1 1 0 4 4 4 4 4 0; ...
    0 0 0 0 0 0 0 0 0 0 0; ...
    0 6 6 6 6 6 6 6 6 6 0; ...
    0 6 6 6 6 6 6 6 6 6 0; ...
    0 6 6 6 6 6 6 6 6 6 0; ...
    0 6 6 6 6 6 6 6 6 6 0; ...
    0 6 6 6 6 6 6 6 6 6 0; ...
    0 6 6 6 6 6 6 6 6 6 0; ...
    0 6 6 6 6 6 6 6 6 6 0; ...
    0 6 6 6 6 6 6 6 6 6 0; ...
    0 6 6 6 6 6 6 6 6 6 0; ...
    0 6 6 6 6 6 6 6 6 6 0; ...
    0 0 0 0 0 0 0 0 0 0 0] ; ...

[circles, labels] = imInscribedCircle(img);

assertEqual(testCase, size(circles), [3 3]);
assertEqual(testCase, length(labels), 3);

expRadius = [2 2 5]';
assertEqual(testCase, circles(:,3), expRadius, 'AbsTol', 0.01);


function test_LabelsTouchingImageBorder(testCase) %#ok<*DEFNU>
% Test call of function without argument.

img = [ ...
    1 1 1 0 4 4 4 4 4; ...
    1 1 1 0 4 4 4 4 4; ...
    1 1 1 0 4 4 4 4 4; ...
    0 0 0 0 0 0 0 0 0; ...
    6 6 6 6 6 6 6 6 6; ...
    6 6 6 6 6 6 6 6 6; ...
    6 6 6 6 6 6 6 6 6; ...
    6 6 6 6 6 6 6 6 6; ...
    6 6 6 6 6 6 6 6 6] ; ...

[circles, labels] = imInscribedCircle(img);

assertEqual(testCase, size(circles), [3 3]);
assertEqual(testCase, length(labels), 3);

expRadius = [3 3 5]';
assertEqual(testCase, circles(:,3), expRadius, 'AbsTol', 0.01);

